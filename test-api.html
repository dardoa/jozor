<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ø§Ø®ØªØ¨Ø§Ø± Gemini API</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 50px auto;
        padding: 20px;
        background: #f5f5f5;
      }

      .container {
        background: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      h1 {
        color: #333;
        text-align: center;
      }

      textarea {
        width: 100%;
        padding: 10px;
        border: 2px solid #ddd;
        border-radius: 5px;
        font-size: 16px;
        resize: vertical;
      }

      button {
        width: 100%;
        padding: 12px;
        background: #0070f3;
        color: white;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        cursor: pointer;
        margin-top: 10px;
      }

      button:hover {
        background: #0051cc;
      }

      button:disabled {
        background: #ccc;
        cursor: not-allowed;
      }

      .result {
        margin-top: 20px;
        padding: 15px;
        background: #f0f7ff;
        border: 1px solid #0070f3;
        border-radius: 5px;
        white-space: pre-wrap;
        max-height: 400px;
        overflow-y: auto;
      }

      .error {
        background: #fff0f0;
        border-color: #ff0000;
        color: #cc0000;
      }

      .loading {
        text-align: center;
        color: #666;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h1>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Gemini API</h1>

      <div>
        <label for="prompt"><strong>Ø£Ø¯Ø®Ù„ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø£Ùˆ Ø§Ù„Ø·Ù„Ø¨:</strong></label>
        <textarea id="prompt" rows="4" placeholder="Ù…Ø«Ø§Ù„: Ø§ÙƒØªØ¨ Ù‚ØµÙŠØ¯Ø© Ù‚ØµÙŠØ±Ø© Ø¹Ù† Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©">
Ø§ÙƒØªØ¨ Ù‚ØµÙŠØ¯Ø© Ù‚ØµÙŠØ±Ø© Ø¹Ù† Ø£Ù‡Ù…ÙŠØ© Ø§Ù„Ø¹Ø§Ø¦Ù„Ø©</textarea
        >
      </div>

      <button id="testBtn" onclick="testAPI()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>

      <div id="result"></div>
    </div>

    <script>
      async function testAPI() {
        const prompt = document.getElementById('prompt').value;
        const resultDiv = document.getElementById('result');
        const btn = document.getElementById('testBtn');

        if (!prompt.trim()) {
          alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø³Ø¤Ø§Ù„ Ø£Ùˆ Ø·Ù„Ø¨');
          return;
        }

        // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø± ÙˆØ¥Ø¸Ù‡Ø§Ø± loading
        btn.disabled = true;
        resultDiv.className = 'result loading';
        resultDiv.textContent = 'â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¥Ù„Ù‰ Gemini API...';

        try {
          const startTime = Date.now();

          const response = await fetch('/api/gemini', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              prompt: prompt,
              action: 'test',
            }),
          });

          const endTime = Date.now();
          const duration = ((endTime - startTime) / 1000).toFixed(2);

          if (!response.ok) {
            const error = await response.json();
            throw new Error(error.error || `HTTP ${response.status}`);
          }

          const data = await response.json();

          // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
          resultDiv.className = 'result';
          resultDiv.innerHTML = `
                    <strong>âœ… Ù†Ø¬Ø­!</strong><br>
                    <strong>Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø³ØªØºØ±Ù‚:</strong> ${duration} Ø«Ø§Ù†ÙŠØ©<br><br>
                    <strong>Ø§Ù„Ø±Ø¯ Ù…Ù† Gemini:</strong><br>
                    ${data.result || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø¯'}
                `;
        } catch (error) {
          const errorData = error.response ? await error.response.json() : null;
          resultDiv.className = 'result error';
          resultDiv.innerHTML = `
                    <strong>âŒ Ø®Ø·Ø£!</strong><br><br>
                    <strong>Ø§Ù„Ø±Ø³Ø§Ù„Ø©:</strong> ${error.message}<br>
                    ${errorData?.details ? `<strong>Ø§Ù„ØªÙØ§ØµÙŠÙ„:</strong> ${errorData.details}<br>` : ''}
                    ${errorData?.status ? `<strong>Status Code:</strong> ${errorData.status}<br>` : ''}
                    <br>
                    <small><strong>Ù†ØµØ§Ø¦Ø­:</strong>
                    <br>1. ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§ÙØ© GEMINI_API_KEY ÙÙŠ .env
                    <br>2. Ø§Ù„Ù…ÙØªØ§Ø­ ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ¨Ø¯Ø£ Ø¨Ù€ AIza...
                    <br>3. ØªØ­Ù‚Ù‚ Ù…Ù† console ÙÙŠ vercel dev
                    <br>4. Ø¬Ø±Ù‘Ø¨ Ù…ÙØªØ§Ø­ Ø¬Ø¯ÙŠØ¯ Ù…Ù†: <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a>
                    </small>
                `;
        } finally {
          btn.disabled = false;
        }
      }

      // Ø§Ø®ØªØ¨Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
      window.addEventListener('load', () => {
        console.log('âœ… ØµÙØ­Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø§Ù‡Ø²Ø©');
        console.log('ğŸ”— ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„: vercel dev');
      });
    </script>
  </body>
</html>
